<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <title>Cyber Formula Mini Race</title>
    <meta name="viewport"
		content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">

    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <style>
        body {margin: 0;  padding: 0;  width: 100%;  height: 100%; background: #2a2a2a; overflow: hidden; font-family: Rajdhani, sans-serif; color: #fff; }
        canvas#game {
		  position: absolute;
		  left: 0;
		  top: 0;
		  width: 100%;
		  height: 100%;
		  background: transparent;
		  border: 0;          /* 去掉黑框，如想要可以改做 box-shadow */
		  display: block;
		  z-index: 1;
		}
		/* 1. 改為藍天背景 */
		#titleScreen {
			position: fixed;
			inset: 0;
			/* 晴朗藍天漸層：從上方較深的藍到下方較亮的天藍 */
			background: linear-gradient(to bottom, #1e5799 0%, #2989d8 50%, #7db9e8 100%);
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			z-index: 999;
		}
		@keyframes gradientBG {
			0% { background-position: 0% 50%; }
			50% { background-position: 100% 50%; }
			100% { background-position: 0% 50%; }
		}

		/* 2. 新增 Logo 圖片樣式 (手機適用) */
		#titleLogo {
			/* 確保在大螢幕上不會超過原始尺寸太多 */
			max-width: 600px; 
			/* 關鍵：在小螢幕 (手機) 上，寬度最多佔 90%，高度自動維持比例 */
			width: 90%;
			height: auto;
			
			margin-bottom: 10px;
			/* 加上一點點浮起的陰影，讓 Logo 更有立體感 */
			filter: drop-shadow(0px 8px 15px rgba(0, 0, 0, 0.4));
			
			/* 進場動畫 (選用)：從上方滑入 */
			animation: slideDown 0.8s ease-out;
		}

		@keyframes slideDown {
			from { transform: translateY(-100px); opacity: 0; }
			to { transform: translateY(0); opacity: 1; }
		}

		/* 3. 調整副標題樣式以配合藍天背景 */
		#titleScreen h2 {
		  font-family: 'Rajdhani', sans-serif;
		  font-size: clamp(24px, 5vw, 60px);  /* 細螢幕縮細，大螢幕最多 60 */
		  color: #00ffea;
		  text-shadow: 0 0 20px #00ffea;
		  margin-top: -10px;
		  letter-spacing: 0.8vw;              /* 用 vw 取代死 10px */
		}

		#checkered {
		  width: min(90vw, 600px);
		  height: auto;
		  aspect-ratio: 15 / 4;               /* 保持原來比例 */
		  display: grid;
		  grid-template-columns: repeat(15, 1fr);
		  grid-template-rows: repeat(4, 1fr);
		  border: 0.8vw solid #fff;
		  box-shadow: 0 0 3vw rgba(255,255,255,0.8);
		  margin: 4vh 0;
		}
        #checkered div { width: 100%; height: 100%; background: #000; }
        #checkered div:nth-child(odd) { background: #fff; }
        #checkered div:nth-child(even) { background: #000; }
        
		#startTitleBtn {
		  background: linear-gradient(45deg, #ff1b6b, #ff8c00);
		  color: #fff;
		  padding: 1.5vh 8vw;
		  font-size: clamp(18px, 4vw, 32px);
		  border: none;
		  border-radius: 60px;
		  cursor: pointer;
		  transition: 0.4s;
		  box-shadow: 0 1.5vh 4vw rgba(255,27,107,0.5);
		  font-weight: 700;
		  letter-spacing: 0.4vw;
		}
        #startTitleBtn:hover { transform: scale(1.1); }
        
        #finishScreen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 999; }
        #finishScreen h1 { font-family: Orbitron, sans-serif; font-size: 120px; color: #00ff41; text-shadow: 0 0 50px #00ff41; }
        #finalPos { font-size: 60px; margin: 30px 0; text-shadow: 0 0 30px #fff; }
        #backToMenuBtn { background: #00ff41; color: #000; padding: 25px 100px; font-size: 45px; border: none; border-radius: 60px; cursor: pointer; font-weight: 700; }
        
		#howToPlay {
			background: rgba(0, 50, 100, 0.4);
			border: 2px solid #00ffff;
			border-radius: 10px;
			padding: 15px;
			margin-top: 20px;
			width: min(80vw, 400px);
			box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
			text-align: left;
		}
		#howToPlay h3 {
			margin: 0 0 10px 0;
			font-family: 'Orbitron';
			color: #ff8c00;
			font-size: 16px;
			border-bottom: 1px solid rgba(255,140,0,0.5);
		}
		#howToPlay ul { list-style: none; padding: 0; margin: 0; }
		#howToPlay li {
			font-size: 13px;
			margin-bottom: 5px;
			color: #fff;
			display: flex;
			justify-content: space-between;
		}
		#howToPlay span { color: #00ffff; font-weight: bold; }
		
        #gameContainer {
		  position: relative;
		  width: 100vw;
		  height: 100vh;
		  margin: 0;
		  overflow: hidden;
		}
        canvas { z-index: 1; }
        #hud, #lapHud, #posHud, #countdown, #tireMonitorContainer { z-index: 10; position: absolute; font-weight: bold; }
		
		
		/* --- TOP HUD BAR --- */
		#hud, #lapHud, #posHud {
			position: absolute;
			top: 10px;
			z-index: 10;
			background: rgba(0,0,0,0.7);
			padding: 8px 15px;
			border-radius: 8px;
			pointer-events: none;
		}
		#hud { left: 10px; font-size: 14px; }
		#lapHud { left: 50%; transform: translateX(-50%); font-size: 18px; border: 2px solid #555; }
		#posHud { right: 10px; font-size: 14px; }
		
		#pitHudPrompt {
		  position: absolute;
		  top: 12vh;
		  right: 3vw;
		  padding: 10px 20px; /* Bigger padding */
		  font-size: 3vh;     /* Bigger font */
		  font-weight: bold;
		  color: #ffffff !important; /* Force white text */
		  background: rgba(0, 0, 0, 0.85);
		  border: 3px solid #00ffff;
		  border-radius: 10px;
		  display: none;
		  z-index: 1000; /* FORCE it to be on top of everything */
		  pointer-events: none;     /* Don't block clicks */
		}

		/* --- LEFT UI COLUMN (Minimap + Tire) --- */
		#minimapCanvas {
			position: absolute;
			left: 10px;
			top: 330px; /* Below the AI Avatar */
			width: 25vw;
			max-width: 200px;
			height: auto;
			z-index: 20;
			border: 2px solid rgba(255,255,255,0.2);
			background: rgba(0,0,0,0.3);
		}


		#tireMonitorContainer {
			position: absolute;
			bottom: 23vh;
			left: 2vw;
			/* Use vh for size so it scales with browser height */
			width: 12vh; 
			height: 12vh;
			min-width: 60px;
			min-height: 60px;
			background: rgba(0, 0, 0, 0.4);
			border-radius: 5px;
			padding: 5px;
			z-index: 20;
		}

		#tireMonitorCanvas {
			width: 100%;
			height: 100%;
			display: block;
		}

		/* --- RIGHT UI COLUMN (Dashboard + Boost) --- */
		#rightUI {
			position: absolute;
			right: 1.5vw;
			bottom: 3vh;
			display: flex;
			flex-direction: column; /* 由上至下堆疊 */
			align-items: flex-end; /* 全部靠右對齊 */
			gap: 1vh; /* 每個組件之間的動態間距 */
			z-index: 100;
			pointer-events: none;
			max-height: 90vh; /* 防止 UI 超過螢幕高度 */
		}

		/* 讓面板在手機上自動縮小 */
		@media screen and (max-width: 768px) {
			#rankingHUD, #lapTimerHUD {
				width: 140px !important;
				padding: 5px;
			}
			#lapTimerDisplay {
				font-size: 16px !important;
			}
			#rankingList {
				font-size: 11px !important;
			}
		}

		/* 統一的 Cyber 面板風格 */
		.cyber-panel {
			background: rgba(0, 20, 50, 0.85);
			border: 2px solid #00ffff;
			box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
			color: #fff;
			font-family: 'Rajdhani', sans-serif;
			padding: 10px;
			clip-path: polygon(10px 0%, 100% 0%, 100% 70%, calc(100% - 10px) 100%, 0% 100%, 0% 30%);
		}

		/* Mode HUD 樣式 */
		#modeHUD {
			padding: 5px 20px;
			font-weight: 700;
			font-size: 1.8vh;
			letter-spacing: 2px;
			min-width: 120px;
			text-align: center;
		}

		/* Radio HUD 樣式 */
		#radioHUD {
			width: 320px;
			min-height: 80px;
			display: flex;
			flex-direction: column;
		}

		.radio-header {
			font-size: 12px;
			color: #00ffff;
			font-weight: bold;
			margin-bottom: 5px;
		}

		.radio-body {
			display: flex;
			align-items: center;
			gap: 10px;
		}

		#radioDriverImg {
			width: 60px;
			height: 60px;
			border: 1px solid #00ffff;
			object-fit: cover;
		}

		#radioText {
			font-size: 16px;
			font-style: italic;
			line-height: 1.2;
		}

		/* Boost 時的變色效果 */
		.boosting-ui {
			border-color: #ff00ff !important;
			box-shadow: 0 0 15px rgba(255, 0, 255, 0.5) !important;
		}
		.boosting-text { color: #ff00ff !important; }

		#dashboardCanvas {
			width: 35vw;
			max-width: 280px;
			height: auto;
		}

		#boostBarContainer { 
			position: relative; /* Changed from absolute to flow inside rightUI */
			width: 35vw;
			max-width: 250px;
			height: 12px;
			background: rgba(0,0,0,0.7); 
			border-radius: 6px; 
			overflow: hidden; 
			border: 2px solid rgba(255,255,255,0.4);
		}

        #boostBar { 
        height: 100%; 
        width: 100%; 
        background: linear-gradient(90deg, #ff3333, #ff6666); 
        transform-origin: left; 
        transform: scaleX(1); 
        transition: transform 0.1s ease-out;
        box-shadow: 2px 0 10px rgba(255, 100, 100, 0.5);
        }
		
		/* --- Mobile 專屬縮小設定 --- */
		@media screen and (max-width: 768px) {
			/* 1. 縮小右側所有面板 */
			#rightUI {
				gap: 5px !important;
				right: 5px !important;
				bottom: 25vh !important; /* 稍微往上提，避開操控鍵 */
				width: 140px !important; /* 強制縮小總寬度 */
			}

			.cyber-panel {
				padding: 5px !important;
				width: 100% !important;
				max-width: 130px !important;
			}

			/* 2. 縮小文字 */
			#rankingList { font-size: 10px !important; }
			#lapTimerDisplay { font-size: 14px !important; }
			.radio-header { font-size: 9px !important; }
			#radioText { font-size: 11px !important; }

			/* 3. 縮小通訊框頭像 */
			#radioDriverImg {
				width: 35px !important;
				height: 35px !important;
			}

			#radioHUD {
				width: 130px !important;
				min-height: 40px !important;
			}

			/* 4. 縮小左側地圖與輪胎監測器 (避免重疊按鈕) */
			#minimapCanvas {
				top: 210px !important; /* 移到 AI 頭像下方 */
				left: 5px !important;
				width: 100px !important; /* 固定寬度，不要太大 */
			}

			#tireMonitorContainer {
				top: 330px !important; /* 緊貼在小地圖下方 */
				bottom: auto !important;
				left: 5px !important;
				width: 60px !important;
				height: 60px !important;
			}

			/* 5. 縮小控制按鈕 (避免佔據半個螢幕) */
			#mobileControls button {
				width: 55px !important;
				height: 55px !important;
				font-size: 10px !important;
			}
			
			#boostBtn {
				width: 80px !important;
				height: 80px !important;
				font-size: 12px !important;
			}
		}

		/* 針對超小螢幕 (例如 iPhone SE) 的極致縮小 */
		@media screen and (max-width: 320px) {
			#radioHUD {
				width: 75vw;
				max-width: 180px;
			}
			#radioDriverImg {
				width: 30px;
				height: 30px;
			}
			#radioText {
				font-size: 11px;
			}
		}
		
		@media screen and (orientation: portrait) {
			#rightUI {
				bottom: 28vh; /* 往上移一點，不要擋到手機的控制按鈕 */
			}
		}		
		
		/* --- MOBILE SPECIFIC FIXES --- */
		@media screen and (orientation: portrait) {
			/* In Portrait, move UI up so it doesn't hide under the mobile buttons */
			#rightUI { bottom: 28vh; }
			#tireMonitorContainer { top: 45vh; }
			#minimapCanvas { top: 200px; width: 30vw; }
			
			/* Make top HUD smaller so they don't overlap in center */
			#hud, #posHud { font-size: 10px; padding: 4px 8px; }
			#lapHud { font-size: 14px; }
		}

		@media screen and (max-width: 600px) {
			/* On very small phones, hide the track name HUD to save space */
			#hud { display: none; }
		}		
		
		#countdown {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: 200px;
			font-weight: bold;
			color: white;
			text-shadow: 0 0 20px rgba(0,0,0,0.8);
			display: none;
			z-index: 100;
		}
        
        .menu { display: none; position: fixed; inset: 0; background: #000; flex-direction: column; align-items: center; overflow-y: auto; z-index: 99; padding: 40px 20px 120px; }
        .menu.active { display: flex; }
		.menu h1 {
		  font-family: Orbitron, sans-serif;
		  font-size: clamp(26px, 5vw, 60px);
		  margin: 2vh 0;
		  text-shadow: 0 0 30px #00ffff;
		}
        
		/* FORMULA SELECT 標題貼頂，不隨中間內容捲走 */
		#carMenu h1 {
		  position: sticky;
		  top: 0;
		  z-index: 2;
		  margin: 0 0 1.5vh 0;
		  padding-bottom: 0.1vh;
		  background: #000;  /* 同 menu 底色，避免和下面重疊 */
		}
		
		/* 4. 菜單畫面 (Mode Select) 視覺修正 */
				#mainMenu.menu {
					/* 覆寫 .menu 的背景為藍天漸層 */
					background: linear-gradient(to bottom, #1e5799 0%, #2989d8 50%, #7db9e8 100%);
					justify-content: center; /* 讓內容垂直居中 */
				}

				/* 複製 #titleLogo 樣式給菜單 Logo */
				.menu-logo {
					max-width: 600px; 
					width: 90%;
					height: auto;
					margin-bottom: 20px; /* 增加與標題的間距 */
					filter: drop-shadow(0px 8px 15px rgba(0, 0, 0, 0.4));
				}
				
				/* 調整 #mainMenu 標題樣式 */
				#mainMenu h1 { 
					/* 使用類似 Title Screen 副標題的樣式 */
					font-family: 'Rajdhani', sans-serif;
					font-size: 50px;
					color: #ffffff;
					margin: 0 0 40px 0;
					letter-spacing: 8px;
					text-shadow: 
						3px 3px 0px #003366, 
						-3px -3px 0px #003366,
						3px -3px 0px #003366,
						-3px 3px 0px #003366;
					font-weight: 700;
				}

				.btn {
				  background: linear-gradient(45deg, #667eea, #764ba2);
				  padding: 1.6vh 5vw;
				  margin: 1.2vh;
				  font-size: clamp(18px, 3.5vw, 28px);
				  border: none;
				  border-radius: 15px;
				  cursor: pointer;
				  width: min(80vw, 500px);
				  transition: 0.3s;
				  box-shadow: 0 10px 30px rgba(102,126,234,0.4);
				}
				.btn:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(102,126,234,0.6); }
        
		#trackSelect h1 {
		  position: sticky;
		  top: 0;
		  z-index: 2;
		  margin: 2vh 0 1.5vh 0;
		  background: #000;              /* 底色防止字同下面 overlap */
		}

		/* Track Grid：有高度限制，只係呢度上下捲 */
		#trackSelect .track-grid {
		  display: grid;
		  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
		  gap: 20px;
		  width: min(95vw, 1100px);
		  margin: 0 auto;

		  /* ⭐ 關鍵：限制高度，track 圖就唔會被剪走 */
		  max-height: calc(100vh - 220px);   /* 視窗高 - 標題/按鈕/上下 padding，數值可微調 */
		  overflow-y: auto;                  /* 只喺呢度 scroll */
		}

		.track-card {
		  background: #111;
		  padding: 20px;
		  border-radius: 15px;
		  cursor: pointer;
		  transition: 0.3s;
		  border: 4px solid transparent;
		  font-size: clamp(15px, 2.5vw, 28px);
		  text-align: center;
		}
		.track-card:hover { transform: scale(1.05); background: #222; }
		.track-card.selected { border: 4px solid #00ff41; background: #003300 !important; }
		.track-card img { width: 80%; max-height: 18vh; max-width: 10vh; object-fit: contain; border-radius: 10px; }
        



		/* FORMULA SELECT Layout：左車卡，右 Spec Panel */
		#carMenu .container {
		  width: 100%;
		  max-width: 1100px;
		  margin: 0 auto;
		  padding: 2vh 1vw 0;

		  display: grid;
		  grid-template-columns: 1.1fr 1.6fr;  /* 左窄右闊 */
		  column-gap: 0.5vw;
		  align-items: flex-start;

		  /* ⭐ 固定中間高度，只係內部元素捲 */
		  max-height: calc(100vh - 160px);  /* 視窗高 - 標題 + 底 padding，可自行微調 */
		}

		/* 左邊車卡區：只有呢度上下捲 */
		#carList {
		  min-width: 0;
		  height: 100%;
		  overflow-y: auto;
		}

		/* 車名 */
		.car-list-container .car-name {
		  margin-top: 0.5vh;
		  font-family: 'Rajdhani', sans-serif;
		  color: #ccc;
		  font-size: clamp(14px, 1.8vw, 22px);
		  letter-spacing: 0.08em;
		}

		/* 如果你想手機再細啲，可以加額外 media query */
		@media (max-width: 768px) {
		  .car-list-container .car-name {
			font-size: clamp(10px, 3vw, 14px);
		  }
		}

		/* 右邊 Spec Panel（desktop：sticky 黐住視窗） */
		#carSpecPanel {
		  min-width: 0;
		  background: rgba(0, 0, 0, 0.75);
		  border-radius: 15px;
		  padding: 1.5vh 1.5vw;
		  border: 2px solid rgba(0, 255, 255, 0.4);
		  box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);

		  display: flex;
		  flex-direction: column;

		  position: sticky;                   /* ⭐ 黐 viewport，而唔係 menu 自己 */
		  top: 90px;                          /* 視覺上喺 FORMULA SELECT 標題下少少 */
		  height: calc(100vh - 140px);        /* 大約由標題下方拉到 browser 底 */
		  max-height: none;
		  overflow-y: auto;                   /* 內容太長時 panel 自己捲 */
		}

		/* Confirm 按鈕永遠喺 panel 底 */
		#confirmBtn {
		  margin-top: 2vh;
		  align-self: stretch;
		  max-width: 15vw;
		}

		/* 細螢幕（例如直向手機）：右邊用 fixed，唔再靠 sticky */
		@media (max-width: 700px) {
		  /* 左右 grid 保持兩欄，但左邊留位畀 fixed panel，唔好俾佢遮晒 */
		  #carMenu .container {
			grid-template-columns: 1fr 1fr;
			column-gap: 1.2vw;
			padding-right: 48vw;        /* ⭐ 後面空位，避免被右邊 panel 蓋住 */
		  }

		  /* 左邊車卡可以自己捲 */
		  #carList {
			overflow-y: auto;
			max-height: calc(100vh - 160px);
		  }

		  /* 右邊 Spec Panel 完全釘死喺 viewport 右邊 */
		  #carSpecPanel {
			position: fixed;            /* ⭐ 由 sticky → fixed */
			top: 10vh;                  /* 視覺上喺 FORMULA SELECT 標題下面 */
			right: 1vw;
			width: min(46vw, 420px);    /* 右欄闊度，大約一半畫面 */
			height: calc(100vh - 16vh); /* 由 top 開始拉到底 */
			overflow-y: auto;
			z-index: 1000;              /* 壓住後面左欄 */
		  }

		  /* Confirm 按鈕保持喺 panel 底 */
		  #confirmBtn {
			align-self: left;
			max-width: 80%;
		  }

		  /* 細機左邊卡片單 column + 圖再細啲 */
		  .car-list-container {
			grid-template-columns: 1fr;
		  }

		  .car-list-container img {
			max-height: 14vh;
		  }
		}



		/* 車隊標題 */
		.team-header {
		  font-family: 'Orbitron', sans-serif;
		  font-size: clamp(18px, 3.2vw, 28px);
		  color: #00ffea;
		  text-shadow: 0 0 10px #00ffea;
		  margin: 3vh 0 1.5vh;
		  border-bottom: 2px solid rgba(0,255,234,0.3);
		  padding-bottom: 0.6vh;
		  text-align: left;
		}

		/* 左邊車卡 Grid */
		.car-list-container {
		  display: grid;
		  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
		  gap: 1.6vh;
		  list-style: none;
		  padding: 0;
		  margin: 0;
		}

		.car-list-container li {
		  background: #222;
		  padding: 1vh 0.8vw;
		  border-radius: 15px;
		  cursor: pointer;
		  transition: 0.2s;
		  border: 4px solid transparent;
		  text-align: center;
		  font-size: clamp(5px, 1.8vw, 10px); 
		}

		.car-list-container li:hover { 
		  transform: scale(1.06); 
		  background: #333; 
		}

		.car-list-container li.selected { 
		  border: 4px solid #0f0; 
		  background: #003300 !important; 
		}

		.car-list-container img {
		  width: 100%;
		  max-height: 10vh;
		  object-fit: contain;
		}

		/* ===== 右邊 SPEC：標題 + SPEED / CONTROL Bar + AERO / TURN ===== */

		#specCarName {
		  font-size: clamp(10px, 5vw, 15px);
		  margin-top: 0.1vh;      /* 上面收窄 */
		  margin-bottom: 0.1vh;   /* 下面收窄 */
		  line-height: 1.0;       /* 行高貼身啲 */
		}

		/* 整個一塊：SPEED / CONTROL */
		.spec-block {
		  margin-top: 1.2vh;
		}

		/* 標題行：左邊文字 + 右邊數值 */
		.spec-title-row {
		  display: flex;
		  align-items: baseline;
		  justify-content: space-between;
		  margin-bottom: 0.3vh;
		  font-size: clamp(12px, 1.7vw, 18px);
		}

		/* 左邊 "SPEED" / "CONTROL" label */
		.spec-label {
		  text-transform: uppercase;
		  letter-spacing: 0.1em;
		  color: #cccccc;
		}

		/* 右邊 "X/10" */
		.spec-value {
		  font-weight: bold;
		  min-width: 40px;
		  text-align: right;
		}

		/* Bar 部份（獨立一行） */
		.spec-bar-bg {
		  width: 100%;
		  height: 1.6vh;
		  min-height: 8px;
		  max-height: 16px;
		  background: #222;
		  border-radius: 8px;
		  overflow: hidden;
		  border: 1px solid rgba(255, 255, 255, 0.2);
		}

		.spec-bar-fill {
		  height: 100%;
		  width: 0%;
		  background: linear-gradient(90deg, #00ff88, #00ccff);
		  transition: width 0.2s ease-out;
		}

		/* AERO / TURN 純文字行 */
		.spec-text-row {
		  display: flex;
		  justify-content: space-between;
		  align-items: baseline;
		  margin-top: 0.8vh;
		  font-size: clamp(12px, 1.7vw, 18px);
		}

		.spec-plain-value {
		  font-weight: 600;
		  color: #ffffff;
		}

		/* Driver 區 */
		#specDriverSection {
		  margin-top: 2vh;
		  padding-top: 1.2vh;
		  border-top: 1px solid rgba(255, 255, 255, 0.15);
		  display: flex;
		  align-items: center;
		  gap: 1vw;
		}

		#specDriverAvatarWrap {
		  width: clamp(70px, 18vw, 120px);
		  height: clamp(70px, 18vw, 120px);
		  border-radius: 50%;
		  overflow: hidden;
		  border: 2px solid rgba(0, 255, 255, 0.6);
		  box-shadow: 0 0 12px rgba(0, 255, 255, 0.4);
		  background: radial-gradient(circle at 30% 30%, #444, #111);
		  flex-shrink: 0;
		}

		#specDriverAvatar {
		  width: 100%;
		  height: 100%;
		  object-fit: cover;
		}

		#specDriverText {
		  display: flex;
		  flex-direction: column;
		}

		#specDriverLabel {
		  font-size: clamp(12px, 2.1vw, 18px);
		  letter-spacing: 0.12em;
		  color: #aaaaaa;
		}

		#specDriverName {
		  font-size: clamp(13px, 2.4vw, 20px);
		  font-weight: 700;
		  color: #ffffff;
		  text-shadow: 0 0 8px rgba(0, 255, 255, 0.7);
		  text-transform: uppercase;
		}

		/* Badge */
		#specBadgeRow {
		  margin-top: 1.4vh;
		  display: flex;
		  flex-wrap: wrap;
		  gap: 0.6vw;
		}

		.spec-badge {
		  font-size: clamp(9px, 1.5vw, 13px);
		  letter-spacing: 0.12em;
		  text-transform: uppercase;
		  padding: 0.4vh 1.2vw;
		  border-radius: 999px;
		  border: 1px solid rgba(0, 255, 255, 0.6);
		  color: #00ffff;
		  background: radial-gradient(circle at 30% 0%, rgba(0,255,255,0.3), transparent 60%);
		  box-shadow: 0 0 10px rgba(0, 255, 255, 0.4);
		  white-space: nowrap;
		}

		/* Team Logo */
		#specTeamLogoSection {
		  margin-top: 3vh;
		  padding-top: 1vh;
		  border-top: 1px solid rgba(255, 255, 255, 0.12);
		  text-align: center;
		}

		#specTeamLogo {
		  max-width: clamp(120px, 32vw, 220px);
		  max-height: clamp(120px, 32vw, 220px);
		  object-fit: contain;
		  opacity: 0.9;
		  filter: drop-shadow(0 0 10px rgba(0, 255, 255, 0.55));
		}

		/* Turn Tips */
		#specTurnTips {
		  margin-top: 1.4vh;
		  padding: 1vh 1.2vw;
		  font-size: clamp(11px, 1.9vw, 16px);
		  line-height: 1.5;
		  color: #cccccc;
		  background: rgba(0, 255, 255, 0.08);
		  border-left: 3px solid rgba(0, 255, 255, 0.6);
		  border-radius: 4px;
		  display: none;
		}

		#specTurnTips .tips-title {
		  color: #00ffff;
		  font-weight: 700;
		  margin-right: 6px;
		}

       
		#mobileControls {
		  display: none; 
		  position: fixed;
		  bottom: 3vh;
		  left: 0;
		  width: 100%;
		  display: flex;
		  justify-content: space-between;
		  padding: 0 4vw;
		  z-index: 200;
		  pointer-events: none;
		}

		#moveVertical,
		#moveHorizontal {
		  display: flex;
		  gap: 5px;
		  pointer-events: auto;
		  align-items: center;
		}

		#moveVertical {
		  flex-direction: column;
		}

		#moveHorizontal {
		  flex-direction: row;
		  position: static;   /* 交俾 flex，唔再用硬座標 */
		  margin-top: 17vw;
		  margin-right: 7vw;
		}

		#mobileControls button {
		  width: 25vw;
		  height: 25vw;
		  max-width: 80px;
		  max-height: 80px;
		  border-radius: 50%;
		  border: 2px solid rgba(255, 255, 255, 0.3);
		  background: rgba(0, 0, 0, 0.6);
		  color: white;
		  font-size: 12px;
		  display: flex;
		  align-items: center;
		  justify-content: center;
		  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
		  transition: all 0.2s;
		  padding: 0;
		  margin: 0;
		}

		#mobileControls button:active {
		  transform: scale(0.9);
		  background: rgba(255, 255, 255, 0.8);
		  color: #000;
		}

		#boostBtn {
		  background: linear-gradient(45deg, #0066ff, #00ccff) !important;
		  margin-right: 10px;
		  margin-left: 0;
		  font-weight: bold;
		  font-size: 16px;
		  padding: 5px;
		  white-space: nowrap;
		  width: 140px;
		  height: 140px;
		  border-radius: 50%;
		} 
		
		#pitBtn {
		  background-color: rgba(255, 165, 0, 0.8);
		  color: white;
		  font-weight: bold;
		}		
		
		/* Cyber System Prompt */
		#cyberPrompt {
			position: absolute;
			left: 10px;
			top: 210px;
			font-size: 12px;
			color: #00ffff;
			text-transform: uppercase;
			font-weight: bold;
			pointer-events: none;
			animation: blink 1s infinite;
		}

		@keyframes blink { 50% { opacity: 0.3; } }

    </style>
</head>
<body>
    <div id="titleScreen">
        <img id="titleLogo" src="Cyber_Formula.png" alt="Cyber Formula Logo">
        <h2>MINI RACE</h2>
        <div id="checkered">
            </div>
        <button id="startTitleBtn">START</button>
    </div>
    
    <div id="finishScreen">
        <h1>FINISH!</h1>
        <p id="finalPos">FINAL POS #1</p>
        <button id="backToMenuBtn">BACK TO MENU</button>
    </div>
    
    <div id="mainMenu" class="menu">
		<img class="menu-logo" src="Cyber_Formula.png" alt="Cyber Formula Logo">
        <h1>MODE SELECT</h1>
        <button class="btn" id="champBtn">CHAMPIONSHIP MODE</button>
        <button class="btn" id="timeBtn">FREE RUN</button>
		
		<div id="howToPlay" style="background: rgba(0, 50, 100, 0.4); border: 2px solid #00ffff; border-radius: 10px; padding: 15px; margin-top: 20px; width: min(80vw, 400px); text-align: left; font-family: Rajdhani;">
			<h3 style="margin: 0 0 10px 0; color: #ff8c00; border-bottom: 1px solid rgba(0,255,255,0.3); font-size: 18px;">SYSTEM MANUAL</h3>
			<ul style="list-style: none; padding: 0; margin: 0; font-size: 14px; color: #fff; line-height: 1.6;">
				<li><span style="color: #00ffff; font-weight: bold; width: 80px; display: inline-block;">ARROWS:</span> MOVE / STEER</li>
				<li><span style="color: #00ffff; font-weight: bold; width: 80px; display: inline-block;">KEY [X]:</span> BOOST PRESSURE</li>
				<li><span style="color: #00ffff; font-weight: bold; width: 80px; display: inline-block;">KEY [P]:</span> PIT REQUEST</li>
				<li><span style="color: #00ffff; font-weight: bold; width: 80px; display: inline-block;">AI HEAD:</span> CYBER ASSISTANT</li>
			</ul>
		</div>
	</div>
    
    <div id="trackSelect" class="menu">
        <h1>TRACK SELECT</h1>
        <div class="track-grid" id="trackGrid"></div>
         <button class="btn" id="confirmTrackBtn">NEXT</button>
    </div>
    
	<div id="carMenu" class="menu">
	  <h1>FORMULA SELECT</h1>
	  <div class="container">
		<div id="carList"></div>
		<!-- ★ 新增：右側 Formula Spec Panel -->
		<div id="carSpecPanel">
		  <h2 id="specCarName">SELECT FORMULA</h2>
		  <!-- SPEED：名稱一行，下面一條 Bar -->
		  <div class="spec-block">
			<div class="spec-title-row">
			  <span class="spec-label">SPEED</span>
			  <span id="specSpeedText" class="spec-value">-</span>
			</div>
			<div class="spec-bar-bg">
			  <div id="specSpeedBar" class="spec-bar-fill"></div>
			</div>
		  </div>

		  <!-- CONTROL：名稱一行，下面一條 Bar -->
		  <div class="spec-block">
			<div class="spec-title-row">
			  <span class="spec-label">CONTROL</span>
			  <span id="specControlText" class="spec-value">-</span>
			</div>
			<div class="spec-bar-bg">
			  <div id="specControlBar" class="spec-bar-fill"></div>
			</div>
		  </div>

		  <!-- AERO 行文字 -->
		  <div class="spec-text-row">
			<span class="spec-label">AERO</span>
			<span id="specAeroText" class="spec-plain-value">-</span>
		  </div>

		  <!-- TURN 行文字 -->
		  <div class="spec-text-row">
			<span class="spec-label">TURN</span>
			<span id="specTurnText" class="spec-plain-value">-</span>
		  </div>
		  
		  <div id="specDriverSection">
			<div id="specDriverAvatarWrap">
			  <img id="specDriverAvatar" src="" alt="Driver" />
			</div>
			<div id="specDriverText">
			  <div id="specDriverLabel">DRIVER</div>
			  <div id="specDriverName">-</div>
			</div>		  
		  </div>
		  
		  <div id="specBadgeRow">
			<span id="specTeamBadge"  class="spec-badge">TEAM</span>
			<span id="specAeroBadge"  class="spec-badge">AERO</span>
			<span id="specBoostBadge" class="spec-badge">BOOST</span>
			<span id="specTurnBadge"  class="spec-badge">TURN</span>
		  </div>
		  
		  <div id="specTeamLogoSection">
			<img id="specTeamLogo" src="" alt="Team Logo">
		  </div>
		  
		  <div id="specTurnTips"></div>
		  <button class="btn" id="confirmBtn">GO!</button>
		  
		  
	    </div>
	  </div>
	
	  
	
	</div>

    
    <div id="gameContainer">
        <canvas id="game" width="1000" height="1600"></canvas>
        <div id="hud"></div>
        <div id="lapHud">LAP 0/5</div>
		<button id="quitBtn" style="display: none; position: absolute; top: 10px; left: 75%; transform: translateX(-50%); z-index: 100; background: rgba(150, 0, 0, 0.7); color: white; border: 2px solid #fff; padding: 5px 20px; border-radius: 5px; font-family: Orbitron; cursor: pointer;">QUIT</button>		
        <div id="posHud">POS #1/11</div>
        <div id="countdown"></div>
		<div id="cyberPrompt">Tap Avatar: System Link</div>
		<div id="rightUI" style="display: none;">
			<!-- 1. 最上方：實時排名面板 -->
			<div id="rankingHUD" class="cyber-panel" style="width: 200px;">
				<div class="radio-header" style="color: #ff8c00;">LIVE RANKING</div>
				<div id="rankingList" style="font-size: 14px; line-height: 1.4;">
					<!-- JS 會在這裡產生排名 -->
				</div>
			</div>

			<!-- 2. 圈速計時面板 -->
			<div id="lapTimerHUD" class="cyber-panel" style="width: 200px; text-align: center;">
				<div class="radio-header" style="color: #00ffff;">LAP TIME</div>
				<div id="lapTimerDisplay" style="font-size: 22px; font-weight: 700; font-family: 'Orbitron';">00:00.00</div>
				<div style="font-size: 11px; color: #aaa; margin-top: 2px;">BEST: <span id="bestLapDisplay">--:--.--</span></div>
			</div>

			<!-- 3. 無線電通訊 (原本有的) -->
			<div id="radioHUD" class="cyber-panel" style="display: none;">
				<div class="radio-header">RADIO LINK: <span id="radioDriverName"></span></div>
				<div class="radio-body">
					<img id="radioDriverImg" src="" alt="">
					<div id="radioText"></div>
				</div>
			</div>

			<!-- 4. 模式顯示 (原本有的) -->
			<div id="modeHUD" class="cyber-panel">
				<span id="modeText">[ CIRCUIT ]</span>
			</div>

			<!-- 5. 儀表板與 Boost Bar (原本有的) -->
			<canvas id="dashboardCanvas" width="400" height="250"></canvas>
			<div id="boostBarContainer">
				<div id="boostBar"></div>
			</div>
		</div>

        <canvas id="minimapCanvas" width="300" height="300"></canvas>

        <div id="tireMonitorContainer">
            <canvas id="tireMonitorCanvas"></canvas>
        </div>

        <div id="pitHudPrompt" style="
          position: absolute;
          top: 15vh;
          right: 3vw;
          padding: 5px 10px;
          font-size: 2.5vh;
          font-weight: bold;
          color: yellow;
          background: rgba(0,0,0,0.6);
          border: 2px solid yellow;
          border-radius: 5px;
          display: none;">
          PIT
        </div>
		
	
		
    </div>

    <!-- ★ 正確的 Mobile Controls Wrapper -->
    <div id="mobileControls" style="display: none;">
      <div id="moveVertical">
        <button id="pitBtn"
          style="
            z-index: 1000;
            pointer-events: auto;
            font-size: 10px;
            font-weight: bold;
            background-color: rgba(255, 165, 0, 0.8);
            color: white;
            border: 2px solid #fff;
            border-radius: 50%;
          ">
          PIT
        </button>
        <button id="btnUp">↑</button>
        <button id="btnDown">↓</button>
      </div>
      <div id="moveHorizontal">
        <button id="boostBtn">BOOST</button>
        <button id="btnLeft">←</button>
        <button id="btnRight">→</button>
      </div>
    </div>

    <!-- ★ 這個多餘的 countdown 建議刪掉，gameContainer 裡已經有一個 -->
    <!-- <div id="countdown"></div> -->

    <script src="cars.js"></script>
    <script src="track.js"></script>
    <script src="game.js"></script>
</body>

</html>
