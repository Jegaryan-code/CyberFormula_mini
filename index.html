<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <title>Cyber Formula Mini Race</title>
    <meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Orbitron:wght@900&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #2a2a2a; overflow: hidden; font-family: Rajdhani, sans-serif; color: #fff; }
        canvas#game { display: block; background: transparent; margin: 20px auto; border: 3px solid #333; z-index: 1; }
		
		/* 1. 改為藍天背景 */
		#titleScreen {
			position: fixed;
			inset: 0;
			/* 晴朗藍天漸層：從上方較深的藍到下方較亮的天藍 */
			background: linear-gradient(to bottom, #1e5799 0%, #2989d8 50%, #7db9e8 100%);
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			z-index: 999;
		}
		@keyframes gradientBG {
			0% { background-position: 0% 50%; }
			50% { background-position: 100% 50%; }
			100% { background-position: 0% 50%; }
		}

		/* 2. 新增 Logo 圖片樣式 (手機適用) */
		#titleLogo {
			/* 確保在大螢幕上不會超過原始尺寸太多 */
			max-width: 600px; 
			/* 關鍵：在小螢幕 (手機) 上，寬度最多佔 90%，高度自動維持比例 */
			width: 90%;
			height: auto;
			
			margin-bottom: 10px;
			/* 加上一點點浮起的陰影，讓 Logo 更有立體感 */
			filter: drop-shadow(0px 8px 15px rgba(0, 0, 0, 0.4));
			
			/* 進場動畫 (選用)：從上方滑入 */
			animation: slideDown 0.8s ease-out;
		}

		@keyframes slideDown {
			from { transform: translateY(-100px); opacity: 0; }
			to { transform: translateY(0); opacity: 1; }
		}

		/* 3. 調整副標題樣式以配合藍天背景 */
		#titleScreen h2 {
			font-family: 'Rajdhani', sans-serif;
			font-size: 50px;
			/* 改為白色文字 */
			color: #ffffff;
			margin: 0 0 40px 0;
			letter-spacing: 8px;
			/* 改用深藍色描邊效果，而非霓虹發光，更像遊戲介面 */
			text-shadow: 
				3px 3px 0px #003366, 
				-3px -3px 0px #003366,
				3px -3px 0px #003366,
				-3px 3px 0px #003366;
			font-weight: 700;
		}


		#titleScreen h2 { 
			font-family: 'Rajdhani', sans-serif; font-size: 60px; color: #00ffea; 
			text-shadow: 0 0 20px #00ffea; margin-top: -10px; letter-spacing: 10px; 
		}

       
       
        #checkered { width: 600px; height: 140px; display: grid; grid-template-columns: repeat(15, 1fr); grid-template-rows: repeat(4, 1fr); border: 8px solid #fff; box-shadow: 0 0 50px rgba(255,255,255,0.8); margin: 50px 0; }
        #checkered div { width: 100%; height: 100%; background: #000; }
        #checkered div:nth-child(odd) { background: #fff; }
        #checkered div:nth-child(even) { background: #000; }
        
        #startTitleBtn { background: linear-gradient(45deg, #ff1b6b, #ff8c00); color: #fff; padding: 25px 90px; font-size: 48px; border: none; border-radius: 60px; cursor: pointer; transition: 0.4s; box-shadow: 0 15px 40px rgba(255,27,107,0.5); font-weight: 700; letter-spacing: 5px; }
        #startTitleBtn:hover { transform: scale(1.1); }
        
        #finishScreen { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 999; }
        #finishScreen h1 { font-family: Orbitron, sans-serif; font-size: 120px; color: #00ff41; text-shadow: 0 0 50px #00ff41; }
        #finalPos { font-size: 60px; margin: 30px 0; text-shadow: 0 0 30px #fff; }
        #backToMenuBtn { background: #00ff41; color: #000; padding: 25px 100px; font-size: 45px; border: none; border-radius: 60px; cursor: pointer; font-weight: 700; }
        
        #gameContainer { position: relative; width: 1000px; height: 1600px; margin: 20px auto; }
        canvas { z-index: 1; }
        #hud, #lapHud, #posHud, #speedHud, #countdown { z-index: 10; position: absolute; font-weight: bold; }
		
		/* 隱藏舊的文字 HUD，準備用 Canvas 畫 */
		#speedHud { display: none; } 
		
		/* 新增儀表板 Canvas */
		#dashboardCanvas {
			position: absolute;
			bottom: 330px;
			right: 30px;
			z-index: 20;
			background: transparent; 
			pointer-events: none; 
		}
		
        #hud { top: 20px; left: 20px; background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 12px; font: 22px Arial; }
        #lapHud { top: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); padding: 12px 35px; border-radius: 12px; font: 32px Arial; }
        #posHud { top: 20px; right: 20px; background: rgba(0,0,0,0.7); padding: 10px 25px; border-radius: 12px; font: 26px Arial; }
        #speedHud { bottom: 240px; right: 30px; background: rgba(255,0,0,0.8); padding: 20px 40px; border-radius: 25px; font: 60px bold Arial; text-shadow: 0 0 20px #ff0000; }
        #boostBarContainer { 
        position: absolute; 
        bottom: 280px; 
        right: 30px; 
        width: 350px; 
        height: 24px; 
        background: rgba(0,0,0,0.7); 
        border-radius: 12px; 
        overflow: hidden; 
        z-index: 10; 
        border: 2px solid rgba(255,255,255,0.4);
        box-shadow: 0 2px 15px rgba(0,0,0,0.6);
        }
        #boostBar { 
        height: 100%; 
        width: 100%; 
        background: linear-gradient(90deg, #ff3333, #ff6666); 
        transform-origin: left; 
        transform: scaleX(1); 
        transition: transform 0.1s ease-out;
        box-shadow: 2px 0 10px rgba(255, 100, 100, 0.5);
      }
		#countdown {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			font-size: 200px;
			font-weight: bold;
			color: white;
			text-shadow: 0 0 20px rgba(0,0,0,0.8);
			display: none;
			z-index: 100;
		}
        
        .menu { display: none; position: fixed; inset: 0; background: #000; flex-direction: column; align-items: center; overflow-y: auto; z-index: 99; padding: 40px 20px 120px; }
        .menu.active { display: flex; }
        .menu h1 { font-family: Orbitron, sans-serif; font-size: 70px; margin: 20px 0; text-shadow: 0 0 30px #00ffff; }
        
		/* 4. 菜單畫面 (Mode Select) 視覺修正 */
				#mainMenu.menu {
					/* 覆寫 .menu 的背景為藍天漸層 */
					background: linear-gradient(to bottom, #1e5799 0%, #2989d8 50%, #7db9e8 100%);
					justify-content: center; /* 讓內容垂直居中 */
				}

				/* 複製 #titleLogo 樣式給菜單 Logo */
				.menu-logo {
					max-width: 600px; 
					width: 90%;
					height: auto;
					margin-bottom: 20px; /* 增加與標題的間距 */
					filter: drop-shadow(0px 8px 15px rgba(0, 0, 0, 0.4));
				}
				
				/* 調整 #mainMenu 標題樣式 */
				#mainMenu h1 { 
					/* 使用類似 Title Screen 副標題的樣式 */
					font-family: 'Rajdhani', sans-serif;
					font-size: 50px;
					color: #ffffff;
					margin: 0 0 40px 0;
					letter-spacing: 8px;
					text-shadow: 
						3px 3px 0px #003366, 
						-3px -3px 0px #003366,
						3px -3px 0px #003366,
						-3px 3px 0px #003366;
					font-weight: 700;
				}

				.btn { background: linear-gradient(45deg, #667eea, #764ba2); padding: 18px 50px; margin: 15px; font-size: 36px; border: none; border-radius: 15px; cursor: pointer; width: 80%; max-width: 500px; transition: 0.3s; box-shadow: 0 10px 30px rgba(102,126,234,0.4); }
				.btn:hover { transform: scale(1.05); box-shadow: 0 15px 40px rgba(102,126,234,0.6); }
        
        /* Track Select */
        #trackSelect .track-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; width: 100%; max-width: 1000px; margin: 30px 0; }
        .track-card { background: #111; padding: 20px; border-radius: 15px; cursor: pointer; transition: 0.3s; border: 4px solid transparent; font-size: 40px; text-align: center; }
        .track-card:hover { transform: scale(1.05); background: #222; }
        .track-card.selected { border: 4px solid #00ff41; background: #003300 !important; }
        .track-card img { width: 100%; max-height: 50vh; object-fit: contain; border-radius: 10px; }
        
        /* Car Select */
        #carMenu .container { max-width: 1000px; width: 95%; padding: 20px 0; }
        #carList { display: block; width: 100%; max-width: 1000px; margin: 30px auto; } /* 替換為 block 容器以便容納標題和列表 */
        
        /* 新增：車隊標題樣式 */
        .team-header {
          font-family: 'Orbitron', sans-serif;
          font-size: 40px;
          color: #00ffea;
          text-shadow: 0 0 10px #00ffea;
          margin: 30px 0 15px;
          border-bottom: 2px solid rgba(0,255,234,0.3);
          padding-bottom: 5px;
          text-align: left;
        }

        /* 新增：車輛列表容器樣式 (代替 #carList 內部的 grid) */
        .car-list-container {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
          gap: 20px;
          list-style: none;
          padding: 0;
          margin: 0;
        }

        /* 使用 li 代替原來的 .card div，並繼承樣式 */
        .car-list-container li {
          background: #222;
          padding: 10px;
          border-radius: 15px;
          cursor: pointer;
          transition: 0.3s;
          border: 4px solid transparent;
          text-align: center;
        }

        .car-list-container li:hover { 
          transform: scale(1.3); 
          background: #333; 
        }

        .car-list-container li.selected { 
          border: 4px solid #0f0; 
          background: #003300 !important; 
        }

        .car-list-container img {
          width: 100%;
          max-height: 200px; 
          object-fit: contain;
        }
        
        /* Mobile Controls: 修正方向鍵位置和樣式 (恢復圓形、置於角落) */
		#mobileControls {
  position: fixed;
  bottom: 0; 
  left: 0;
  width: 100%; 
  display: flex;
  justify-content: space-between;
  padding: 20px;
  z-index: 100;
  pointer-events: none;
}

#moveVertical,
#moveHorizontal {
  display: flex;
  gap: 20px;
  pointer-events: auto;
  align-items: center;
}

#moveVertical {
  flex-direction: column;
}

#moveHorizontal {
  position: absolute;
  right: 40px;
  bottom: 20px;
  flex-direction: row;
}

#mobileControls button {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.3);
  background: rgba(0, 0, 0, 0.6);
  color: white;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
  transition: all 0.2s;
  padding: 0;
  margin: 0;
}

#mobileControls button:active {
  transform: scale(0.9);
  background: rgba(255, 255, 255, 0.8);
  color: #000;
}

#boostBtn {
  background: linear-gradient(45deg, #0066ff, #00ccff) !important;
  margin-right: 10px;
  margin-left: 0;
  font-weight: bold;
  font-size: 16px;
  padding: 5px;
  white-space: nowrap;
  width: 140px;
  height: 140px;
  border-radius: 50%;
} 
		/* 新增 Minimap Canvas 樣式 */
		#minimapCanvas {
			position: absolute;
			top: 60px; /* 放在 #hud (Top: 20px, Height: 40px) 的下方 */
			left: 20px;
			z-index: 20;
			/* 讓它有一個深色邊框和背景 */
			background: transparent; /* 深灰/黑色背景 */
			
		}

    </style>
</head>
<body>
    <div id="titleScreen">
        <img id="titleLogo" src="Cyber_Formula.png" alt="Cyber Formula Logo">
        <h2>MINI RACE</h2>
        <div id="checkered">
            </div>
        <button id="startTitleBtn">START</button>
    </div>
    
    <div id="finishScreen">
        <h1>FINISH!</h1>
        <p id="finalPos">FINAL POS #1</p>
        <button id="backToMenuBtn">BACK TO MENU</button>
    </div>
    
    <div id="mainMenu" class="menu">
		<img class="menu-logo" src="Cyber_Formula.png" alt="Cyber Formula Logo">
        <h1>MODE SELECT</h1>
        <button class="btn" id="champBtn">CHAMPIONSHIP MODE</button>
        <button class="btn" id="timeBtn">FREE RUN</button>
    </div>
    
    <div id="trackSelect" class="menu">
        <h1>TRACK SELECT</h1>
        <div class="track-grid" id="trackGrid"></div>
        <button class="btn" id="confirmTrackBtn">CONFIRM</button>
    </div>
    
    <div id="carMenu" class="menu">
        <h1>FORMULA SELECT</h1>
        <div class="container">
            <div id="carList"></div>
        </div>
        <button class="btn" id="confirmBtn">CONFIRM</button>
    </div>
    
    <div id="gameContainer">
        <canvas id="game" width="1000" height="1600"></canvas>
        <div id="hud"></div>
        <div id="lapHud">LAP 0/5</div>
        <div id="posHud">POS #1/11</div>
        <div id="speedHud">0 kmh</div>
        <div id="countdown"></div>
		<canvas id="dashboardCanvas" width="400" height="250"></canvas>
		<div id="boostBarContainer">
			<div id="boostBar"></div>
		</div>
		<canvas id="minimapCanvas" width="300" height="300"></canvas>
		<div id="tireMonitorContainer" style="position: absolute; top: 80px; right: 40px; width: 100px; height: 100px; background: rgba(0, 0, 0, 0.4); border-radius: 5px; padding: 5px;">
        <canvas id="tireMonitorCanvas" width="100" height="100"></canvas>
		</div>
		<div id="pitHudPrompt" style="
			position: absolute; 
			top: 200px; 
			right: 50px; /* 放在輪胎 HUD 下邊 */
			padding: 5px 10px; 
			font-size: 24px; 
			font-weight: bold; 
			color: yellow; 
			background: rgba(0, 0, 0, 0.6); 
			border: 2px solid yellow; 
			border-radius: 5px;
			display: none;">
			PIT
		</div>
    </div>
    
	 <div id="mobileControls">
	  <button id="pitBtn" style="
        position: absolute; 
        top:190px; 
        left: 190px; 
        width: 100px; 
        height: 100px;
		z-index: 1000;
		pointer-events: auto;
        font-size: 20px; 
        font-weight: bold;
        background-color: rgba(255, 165, 0, 0.8); /* 橘色 */
        color: white; 
        border: 2px solid #fff; 
        border-radius: 50%;">
        PIT
      </button>
	  <div id="moveVertical">
		<button id="btnUp">↑</button>
		<button id="btnDown">↓</button>
	  </div>
	  <div id="moveHorizontal">
		<button id="boostBtn">BOOST</button>
		<button id="btnLeft">←</button>
		<button id="btnRight">→</button>
	  </div>
	</div>
	<div id="countdown"></div>


    <script src="cars.js"></script>
    <script src="track.js"></script>
    <script src="game.js"></script>
</body>
</html>
